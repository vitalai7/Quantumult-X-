#!name=Cloudflare WARP 分流规则
#!desc=将 Cloudflare / OpenAI / Speedtest 等流量通过 WARP 节点路由
#!author=vitalai x ChatGPT
#!category=Network
#!system=ios
#!icon=https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/icon/Cloudflare.png

[Rule]
# ======= Cloudflare 官方服务 =======
DOMAIN-SUFFIX,cloudflare.com,WARP
DOMAIN-SUFFIX,workers.dev,WARP
DOMAIN-SUFFIX,cloudflarestatus.com,WARP
DOMAIN-SUFFIX,cfargotunnel.com,WARP
DOMAIN-SUFFIX,cloudflareresolve.com,WARP
DOMAIN-SUFFIX,cloudflareclient.com,WARP
DOMAIN-SUFFIX,cloudflarewarp.com,WARP
DOMAIN-SUFFIX,cloudflareaccess.com,WARP

# ======= Cloudflare IP 范围 =======
IP-CIDR,162.159.0.0/16,WARP,no-resolve
IP-CIDR,104.16.0.0/12,WARP,no-resolve
IP-CIDR,104.17.0.0/13,WARP,no-resolve
IP-CIDR,104.18.0.0/14,WARP,no-resolve
IP-CIDR,141.101.64.0/18,WARP,no-resolve
IP-CIDR,172.64.0.0/13,WARP,no-resolve

# ======= OpenAI （避免国内 DNS 劫持） =======
DOMAIN-SUFFIX,openai.com,WARP
DOMAIN-SUFFIX,chat.openai.com,WARP
DOMAIN-SUFFIX,api.openai.com,WARP
DOMAIN-SUFFIX,cdn.openai.com,WARP
DOMAIN-SUFFIX,auth0.openai.com,WARP

# ======= Speedtest 测速 =======
DOMAIN-SUFFIX,speed.cloudflare.com,WARP
DOMAIN-SUFFIX,speedtest.net,WARP
DOMAIN-SUFFIX,ooklaserver.net,WARP

# ======= Cloudflare CDN 常用 =======
DOMAIN-SUFFIX,trycloudflare.com,WARP
DOMAIN-SUFFIX,cf-ipfs.com,WARP
DOMAIN-SUFFIX,cdn.cloudflare.net,WARP
DOMAIN-SUFFIX,cdn-cgi.com,WARP
DOMAIN-SUFFIX,1.1.1.1,WARP
DOMAIN-SUFFIX,warp.plus,WARP

# ======= 常用开发资源（可用 WARP 加速） =======
DOMAIN-SUFFIX,githubusercontent.com,WARP
DOMAIN-SUFFIX,ghcr.io,WARP
DOMAIN-SUFFIX,npmjs.com,WARP
DOMAIN-SUFFIX,jsdelivr.net,WARP

# ======= 网络诊断 =======
DOMAIN-SUFFIX,ip-api.com,WARP
DOMAIN-SUFFIX,ip.sb,WARP
DOMAIN-SUFFIX,ifconfig.me,WARP
DOMAIN-SUFFIX,icanhazip.com,WARP

# ======= Google 检测服务 =======
DOMAIN-SUFFIX,connectivitycheck.gstatic.com,WARP
DOMAIN-SUFFIX,clients3.google.com,WARP
DOMAIN-SUFFIX,clients4.google.com,WARP

# ======= 进程直连（避免循环代理） =======
PROCESS-NAME,warp-svc,DIRECT
PROCESS-NAME,warp-cli,DIRECT

# ======= 结束 =======
